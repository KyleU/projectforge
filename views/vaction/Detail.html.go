// Code generated by qtc from "Detail.html". DO NOT EDIT.
// See https://github.com/valyala/quicktemplate for details.

//line views/vaction/Detail.html:1
package vaction

//line views/vaction/Detail.html:1
import (
	"strings"

	"github.com/kyleu/projectforge/app"
	"github.com/kyleu/projectforge/app/action"
	"github.com/kyleu/projectforge/app/controller/cutil"
	"github.com/kyleu/projectforge/app/util"
)

//line views/vaction/Detail.html:10
import (
	qtio422016 "io"

	qt422016 "github.com/valyala/quicktemplate"
)

//line views/vaction/Detail.html:10
var (
	_ = qtio422016.Copy
	_ = qt422016.AcquireByteBuffer
)

//line views/vaction/Detail.html:10
func StreamDetail(qw422016 *qt422016.Writer, cfg util.ValueMap, res *action.Result, includeSkipped bool, as *app.State, ps *cutil.PageState) {
//line views/vaction/Detail.html:10
	qw422016.N().S(`
  <div class="card">
    <h3>Config</h3>
    <table>
      <tbody>
`)
//line views/vaction/Detail.html:15
	for _, k := range cfg.Keys() {
//line views/vaction/Detail.html:15
		qw422016.N().S(`        <tr>
          <th class="shrink">`)
//line views/vaction/Detail.html:17
		qw422016.E().S(k)
//line views/vaction/Detail.html:17
		qw422016.N().S(`</th>
          <td>`)
//line views/vaction/Detail.html:18
		qw422016.E().V(cfg[k])
//line views/vaction/Detail.html:18
		qw422016.N().S(`</td>
        </tr>
`)
//line views/vaction/Detail.html:20
	}
//line views/vaction/Detail.html:20
	qw422016.N().S(`      </tbody>
    </table>
  </div>
`)
//line views/vaction/Detail.html:24
	if len(res.Errors) > 0 {
//line views/vaction/Detail.html:24
		qw422016.N().S(`  <div class="card">
    <div class="right">`)
//line views/vaction/Detail.html:26
		qw422016.N().D(len(res.Errors))
//line views/vaction/Detail.html:26
		qw422016.N().S(` `)
//line views/vaction/Detail.html:26
		qw422016.E().S(util.PluralMaybe("error", len(res.Errors)))
//line views/vaction/Detail.html:26
		qw422016.N().S(`</div>
    <h3>Errors</h3>
    <ul>
`)
//line views/vaction/Detail.html:29
		for _, e := range res.Errors {
//line views/vaction/Detail.html:29
			qw422016.N().S(`      <li class="error">`)
//line views/vaction/Detail.html:30
			qw422016.E().S(e)
//line views/vaction/Detail.html:30
			qw422016.N().S(`</li>
`)
//line views/vaction/Detail.html:31
		}
//line views/vaction/Detail.html:31
		qw422016.N().S(`    </ul>
  </div>
`)
//line views/vaction/Detail.html:34
	}
//line views/vaction/Detail.html:35
	if len(res.Logs) > 0 {
//line views/vaction/Detail.html:35
		qw422016.N().S(`  <div class="card">
    <h3>Logs</h3>
    <table>
      <tbody>
`)
//line views/vaction/Detail.html:40
		for _, l := range res.Logs {
//line views/vaction/Detail.html:40
			qw422016.N().S(`        <tr>
          <td><pre>`)
//line views/vaction/Detail.html:42
			qw422016.E().S(l)
//line views/vaction/Detail.html:42
			qw422016.N().S(`</pre></td>
        </tr>
`)
//line views/vaction/Detail.html:44
		}
//line views/vaction/Detail.html:44
		qw422016.N().S(`      </tbody>
    </table>
  </div>
`)
//line views/vaction/Detail.html:48
	}
//line views/vaction/Detail.html:49
	for _, mr := range res.Modules {
//line views/vaction/Detail.html:51
		links := ""
		for mIdx, mk := range mr.Keys {
			if mIdx > 0 {
				links += ", "
			}
			links += `<a href="/m/` + mk + `">` + mk + `</a>`
		}

//line views/vaction/Detail.html:58
		qw422016.N().S(`    <div class="card">
      <div class="right">`)
//line views/vaction/Detail.html:60
		qw422016.E().S(util.MicrosToMillis(mr.Duration))
//line views/vaction/Detail.html:60
		qw422016.N().S(`</div>
      <h3>`)
//line views/vaction/Detail.html:61
		qw422016.E().S(util.PluralMaybe("Module", len(mr.Keys)))
//line views/vaction/Detail.html:61
		qw422016.N().S(` [`)
//line views/vaction/Detail.html:61
		qw422016.N().S(links)
//line views/vaction/Detail.html:61
		qw422016.N().S(`]</h3>
      <div class="right"><em>`)
//line views/vaction/Detail.html:62
		qw422016.E().S(res.StatusLog())
//line views/vaction/Detail.html:62
		qw422016.N().S(`</em></div>
      <em>`)
//line views/vaction/Detail.html:63
		qw422016.E().S(mr.Status)
//line views/vaction/Detail.html:63
		qw422016.N().S(`</em>
`)
//line views/vaction/Detail.html:64
		if len(mr.Actions) > 0 {
//line views/vaction/Detail.html:64
			qw422016.N().S(`      <h4>Actions</h4>
`)
//line views/vaction/Detail.html:66
			for _, a := range mr.Actions {
//line views/vaction/Detail.html:66
				qw422016.N().S(`        <a href="`)
//line views/vaction/Detail.html:67
				qw422016.E().S(a.URL())
//line views/vaction/Detail.html:67
				qw422016.N().S(`"><button>`)
//line views/vaction/Detail.html:67
				qw422016.E().S(a.Title)
//line views/vaction/Detail.html:67
				qw422016.N().S(`</button></a>
`)
//line views/vaction/Detail.html:68
			}
//line views/vaction/Detail.html:69
		}
//line views/vaction/Detail.html:70
		diffs := mr.DiffsFiltered(includeSkipped)

//line views/vaction/Detail.html:71
		if len(diffs) > 0 {
//line views/vaction/Detail.html:71
			qw422016.N().S(`      <h4>Diffs</h4>
      <table>
        <thead>
          <tr>
            <th class="shrink">Path</th>
            <th class="shrink">Status</th>
            <th class="shrink">Patch</th>
          </tr>
        </thead>
        <tbody>
`)
//line views/vaction/Detail.html:82
			for _, d := range diffs {
//line views/vaction/Detail.html:82
				qw422016.N().S(`          <tr>
            <td class="shrink">`)
//line views/vaction/Detail.html:84
				qw422016.E().S(d.Path)
//line views/vaction/Detail.html:84
				qw422016.N().S(`</td>
            <td>
              `)
//line views/vaction/Detail.html:86
				qw422016.E().S(d.Status.String())
//line views/vaction/Detail.html:86
				qw422016.N().S(`
`)
//line views/vaction/Detail.html:87
				if true {
//line views/vaction/Detail.html:87
					qw422016.N().S(`              <form action="/run/`)
//line views/vaction/Detail.html:88
					qw422016.E().S(res.Project.Key)
//line views/vaction/Detail.html:88
					qw422016.N().S(`/merge" method="get">
                <input type="hidden" name="file" value="`)
//line views/vaction/Detail.html:89
					qw422016.E().S(d.Path)
//line views/vaction/Detail.html:89
					qw422016.N().S(`" />
                <button type="submit" name="to" value="module" title="Incorporate change into module">&lt;-</button>
                <button type="submit" name="to" value="project" title="Overwrite project changes with module version">-&gt;</button>
              </form>
`)
//line views/vaction/Detail.html:93
				}
//line views/vaction/Detail.html:93
				qw422016.N().S(`            </td>
            <td>`)
//line views/vaction/Detail.html:95
				streamrenderPatch(qw422016, d.Patch, as, ps)
//line views/vaction/Detail.html:95
				qw422016.N().S(`</td>
          </tr>
`)
//line views/vaction/Detail.html:97
			}
//line views/vaction/Detail.html:97
			qw422016.N().S(`        </tbody>
      </table>
`)
//line views/vaction/Detail.html:100
		}
//line views/vaction/Detail.html:100
		qw422016.N().S(`    </div>
`)
//line views/vaction/Detail.html:102
	}
//line views/vaction/Detail.html:103
}

//line views/vaction/Detail.html:103
func WriteDetail(qq422016 qtio422016.Writer, cfg util.ValueMap, res *action.Result, includeSkipped bool, as *app.State, ps *cutil.PageState) {
//line views/vaction/Detail.html:103
	qw422016 := qt422016.AcquireWriter(qq422016)
//line views/vaction/Detail.html:103
	StreamDetail(qw422016, cfg, res, includeSkipped, as, ps)
//line views/vaction/Detail.html:103
	qt422016.ReleaseWriter(qw422016)
//line views/vaction/Detail.html:103
}

//line views/vaction/Detail.html:103
func Detail(cfg util.ValueMap, res *action.Result, includeSkipped bool, as *app.State, ps *cutil.PageState) string {
//line views/vaction/Detail.html:103
	qb422016 := qt422016.AcquireByteBuffer()
//line views/vaction/Detail.html:103
	WriteDetail(qb422016, cfg, res, includeSkipped, as, ps)
//line views/vaction/Detail.html:103
	qs422016 := string(qb422016.B)
//line views/vaction/Detail.html:103
	qt422016.ReleaseByteBuffer(qb422016)
//line views/vaction/Detail.html:103
	return qs422016
//line views/vaction/Detail.html:103
}

//line views/vaction/Detail.html:105
func streamrenderPatch(qw422016 *qt422016.Writer, patch string, as *app.State, ps *cutil.PageState) {
//line views/vaction/Detail.html:106
	lines := strings.Split(patch, "\n")

//line views/vaction/Detail.html:106
	qw422016.N().S(`<pre>`)
//line views/vaction/Detail.html:108
	for _, line := range lines {
//line views/vaction/Detail.html:109
		if len(line) > 0 {
//line views/vaction/Detail.html:110
			switch line[0] {
//line views/vaction/Detail.html:111
			case ' ':
//line views/vaction/Detail.html:111
				qw422016.N().S(`<div style="color: grey;">`)
//line views/vaction/Detail.html:112
				qw422016.E().S(line[1:])
//line views/vaction/Detail.html:112
				qw422016.N().S(`</div>`)
//line views/vaction/Detail.html:113
			case '+':
//line views/vaction/Detail.html:113
				qw422016.N().S(`<div style="color: green;">`)
//line views/vaction/Detail.html:114
				qw422016.E().S(line[1:])
//line views/vaction/Detail.html:114
				if len(line) == 1 {
//line views/vaction/Detail.html:114
					qw422016.N().S(`&nbsp;`)
//line views/vaction/Detail.html:114
				}
//line views/vaction/Detail.html:114
				qw422016.N().S(`</div>`)
//line views/vaction/Detail.html:115
			case '-':
//line views/vaction/Detail.html:115
				qw422016.N().S(`<div style="color: red;">`)
//line views/vaction/Detail.html:116
				qw422016.E().S(line[1:])
//line views/vaction/Detail.html:116
				if len(line) == 1 {
//line views/vaction/Detail.html:116
					qw422016.N().S(`&nbsp;`)
//line views/vaction/Detail.html:116
				}
//line views/vaction/Detail.html:116
				qw422016.N().S(`</div>`)
//line views/vaction/Detail.html:117
			default:
//line views/vaction/Detail.html:118
				qw422016.E().S(line)
//line views/vaction/Detail.html:119
			}
//line views/vaction/Detail.html:120
		}
//line views/vaction/Detail.html:121
	}
//line views/vaction/Detail.html:121
	qw422016.N().S(`</pre>`)
//line views/vaction/Detail.html:123
}

//line views/vaction/Detail.html:123
func writerenderPatch(qq422016 qtio422016.Writer, patch string, as *app.State, ps *cutil.PageState) {
//line views/vaction/Detail.html:123
	qw422016 := qt422016.AcquireWriter(qq422016)
//line views/vaction/Detail.html:123
	streamrenderPatch(qw422016, patch, as, ps)
//line views/vaction/Detail.html:123
	qt422016.ReleaseWriter(qw422016)
//line views/vaction/Detail.html:123
}

//line views/vaction/Detail.html:123
func renderPatch(patch string, as *app.State, ps *cutil.PageState) string {
//line views/vaction/Detail.html:123
	qb422016 := qt422016.AcquireByteBuffer()
//line views/vaction/Detail.html:123
	writerenderPatch(qb422016, patch, as, ps)
//line views/vaction/Detail.html:123
	qs422016 := string(qb422016.B)
//line views/vaction/Detail.html:123
	qt422016.ReleaseByteBuffer(qb422016)
//line views/vaction/Detail.html:123
	return qs422016
//line views/vaction/Detail.html:123
}
